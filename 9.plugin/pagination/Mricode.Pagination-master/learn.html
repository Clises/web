<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
    <meta charset="utf-8"/>
    <link href="mricode.pagination.css" rel="stylesheet"/>
    <script src="jquery-2.1.4.min.js"></script>
    <script src="mricode.pagination.js"></script>
</head>
<body>
<div>
    <!--<div>-->
    <!--pageIndex <input id="pageIndex" type="text" name="name" value="0" />-->
    <!--pageSize <input id="pageSize" type="text" name="name" value="10" />-->
    <!--total <input id="total" type="text" name="name" value="216" />-->
    <!--<button id="btn_init" type="button">初始化</button>-->
    <!--<button id="btn_render" type="button">重新生成</button>-->
    <!--<button id="btn_destroy" type="button">销毁</button>-->
    <!--<button id="btn_isInited" type="button">是否初始化</button>-->
    <!--</div>-->
</div>
<!--创建分页显示标签-->
<div id="page" class="m-pagination"></div>
<div id="eventLog"></div>
<script>
    <!--标签初始化-->
    // $("#page").pagination({
    //     pageIndex: 0, //指定当前页数
    //     pageSize: 10, //每页显示数据
    //     total: 100, //总数据
    //     pageBtnCount: 2,
    //     prevBtnText: "上一页",
    //     nextBtnText: "下一页",
    //     showInfo: true,
    //     showJump: true,//跳转到指定页面
    //     loadFirstPage: true,// 是否加载第一页
    //     // showPageSizes: true,   //是否显示选择每页的数量
    //     debug: true,
    //     showPageSizes: true,
    //     pageElementSort: ['$page', '$size', '$jump', '$info']
    //
    // });

    $("#page").pagination({
        pageIndex:0,
        pageSize:10,
        total:1000,
        // pageIndex: pageIndex.value,
        // pageSize: pageSize.value,
        // total: total.value,
        debug: true,
        showInfo: true,
        showJump: true,
        jumpBtnText:"跳转",
        showFirstLastBtn:3,
        nextBtnText:"下一张",
        prevBtnText:"上一张",
        // showPageSizes: true,
        pageElementSort: ['$page', '$size', '$jump', '$info']
    });
    ;
    //按钮点击事件
    $("#page").on("pageClicked", function (event, data) {
        $.ajax({
            //链接地址
            url: "<?=base_url('lists/ajaxWikiList');?>" + '/' + '<?=$category?>',
            type: "POST",
            dataType: "json",
            data: {offset: data.pageIndex},
            success: function (data) {
                var result = wikilists(data);
                $('.am-list').children().remove();
                $('.am-list').append(result);
            }
        });
    });
    //跳转按钮点击事件
    $("#page").on("jumpClicked", function (event, data) {
        console.log('aaa')

        $.ajax({
            url: "<?=base_url('lists/ajaxWikiList');?>" + '/' + '<?=$category?>',
            type: "POST",
            dataType: "json",
            data: {offset: data.pageIndex},
            success: function (data) {
                var result = wikilists(data);
                $('.am-list').children().remove(); // 找到要替换的列表下的子元素，remove掉
                $('.am-list').append(result); // 将新的列表 追加到对应列表下
            }
        });
    });

    //ajax返回的数据，字符串
    function wikilists(data) {
        var jsonData = eval(data);
        var num = jsonData.length;
        var str = '';
        var baseurl = '<?=base_url()?> detail/wiki/' + '<?=$category?>' + '/';
        var type = '<?=$category?>';
        if (type == 'additive') {
            for (var i = 0; i < num; i++) {
                str += "<li><a href='http://crabshell.applinzi.com/?/" + baseurl + jsonData[i]._id + "'>" + jsonData[i].add_name + "</a></li>";
            }
        } else {
            for (var i = 0; i < num; i++) {
                str += "<li><a href='http://crabshell.applinzi.com/?/" + baseurl + jsonData[i].id + "'>" + jsonData[i].title + "</a></li>";
            }
        }
        return str;
    }

    // btn_init.onclick = function () {
    // //if ($("#page").pagination()) {
    // // $("#page").pagination('destroy');
    // //}
    // $("#page").pagination({
    // pageIndex: pageIndex.value,
    // pageSize: pageSize.value,
    // total: total.value,
    // debug: true,
    // showInfo: true,
    // showJump: true,
    // showPageSizes: true,
    // pageElementSort: ['$page', '$size', '$jump', '$info']
    // });
    //
    // }
    // btn_render.onclick = function () {
    // $("#page").pagination('setPageIndex', pageIndex.value);
    // $("#page").pagination('setPageSize', pageSize.value);
    // $("#page").pagination('render', total.value);
    // }
    // btn_destroy.onclick = function () {
    // $("#page").pagination('destroy');
    // alert('销毁：$("XXX").pagination("destroy")');
    // }
    // btn_isInited.onclick = function () {
    // var isInited = $("#page").pagination();
    // var text = '判断是否初始化：$("XXX").pagination() 返回Boolean \r当前：' + (isInited ? "已初始化" : "未初始化");
    // alert(text);
    // }
    //
    // $("#page").on("pageClicked", function (event, data) {
    //     $("#eventLog").append('EventName = pageClicked , pageIndex = ' + data.pageIndex + '<br/>');
    // }).on('jumpClicked', function (event, data) {
    //     $("#eventLog").append('EventName = jumpClicked , pageIndex = ' + data.pageIndex + '<br/>');
    // }).on('pageSizeChanged', function (event, data) {
    //     $("#eventLog").append('EventName = pageSizeChanged , pageSize = ' + data.pageSize + '<br/>');
    // });
</script>
</body>
</html>
